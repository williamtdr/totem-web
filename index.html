<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Totem</title>
	<link href="http://totem.fm/css/common/background.css" rel="stylesheet">
	<link href="http://totem.fm/css/vendor/bootstrap.min.css" rel="stylesheet">
	<link href="http://totem.fm/css/vendor/font-awesome.min.css" rel="stylesheet">
	<link href="http://totem.fm/css/vendor/animsition.min.css" rel="stylesheet">
	<link href="http://totem.fm/css/vendor/flat-ui.min.css" rel="stylesheet">
	<link href="http://totem.fm/css/vendor/bootstrap-modal.css" rel="stylesheet">
	<link href="http://totem.fm/css/player/player.css" rel="stylesheet">
	<link href="http://totem.fm/css/common/home.css" rel="stylesheet">
</head>
<body>
<div id="background_layer"></div>
<div id="background_shader"></div>
<div class="site_navigation">
	<div class="logo">totem</div>
	<div role="navigation">
		<span class="navigation_option active" id="nav_rooms" onclick="switchTab('rooms')">Rooms</span>
		<span class="navigation_option" id="nav_room" onclick="switchTab('now_playing')"><span id="now-playing-full">Now </span>Playing</span>
		<span class="navigation_option" id="nav_music" onclick="switchTab('my_music')">My Music</span>
	</div>
	<div class="login-menu">
		<?php
		if(isset($authUrl)) {
			echo "<a href=\"".$authUrl."\">Log In<span id=\"login-full\"> with Google</span></a>";
		} else {
			echo "<a href=\"/logout\"><span id=\"login-full\">Hi, </span>".$user->display_name."</a>";
		}
		?>
	</div>
</div>
<div id="disconnected" class="animsition" hidden="hidden">
	<i class="fa fa-exclamation-triangle disconnected-triangle"></i>
	<div class="disconnected-header">Disconnected
		<div class="disconnected-body">
			The server is probably restarting or being worked on. Refreshing in <span id="disconnected-countdown">3</span>...
		</div>
	</div>
</div>
<div id="my_music" class="animsition container" hidden="hidden">
	<div class="sidebar-playlist-list<?php if(isset($authUrl)) echo ' sidebar-no-login'?>">
		<?php
		if(isset($authUrl)) {
			echo "<a href=\"".$authUrl."\">Log in</a> to see your playlists";
		} else {
			echo "<ul class=\"list-group sidebar-playlist\">";
			echo "    <li class=\"list-group-item\" onclick=\"showSearch()\">Search YouTube</li>";
			foreach($playlists as $title => $link) echo "    <li class=\"list-group-item\" onclick=\"loadPlaylistItems('".$link."')\">".$title."</li>";
			echo "</ul>";
		}
		?>
	</div>
	<div class="sidebar-playlist-items" hidden="hidden">
                    <span class="playlist-list-return" onclick="returnToPlaylistList()">
                        &laquo; Playlists
                    </span>
		<ul class="list-group sidebar-playlist playlist-list-content">
			<li class="list-group-item playlist">
				Loading...
			</li>
		</ul>
	</div>
	<div class="sidebar-search animisition" hidden="hidden">
                <span class="playlist-list-return" onclick="returnToPlaylistList()">
                    &laquo; Search
                </span>
		<div id="search-textbox" class="input-group">
			<input type="text" class="form-control" id="search_text" placeholder="Search Youtube">
                    <span class="input-group-btn" style="font-size: 1.4em">
                       <button class="btn btn-primary" type="button" id="search_send">Search</button>
                      </span>
		</div>
	</div>
</div>
<div id="room_list" class="animsition container" hidden="hidden">
	<?php
	if($user->can_change_username) require("content/changeUsername.php");
	?>
	<div class="row">
		<div class="col-sm-4">
			<div class="panel panel-default panel-dark">
				<div class="panel-body room-list-tools">
					<span class="room-list-intro">
						<b>Be a DJ.</b> Or just hang out! Totem lets you find great music through awesome communities.
					</span>
					<a class="room-option room-option-green" onclick="showCreateForm()">
						<i class="fa fa-plus"></i>Create Room
					</a>
					<span class="room-option room-option-orange">
						<i class="fa fa-refresh"></i>Refresh List
					</span>
					<span class="room-option room-option-blue">
						<i class="fa fa-expand"></i>Show All Rooms
					</span>
				</div>
			</div>
		</div>
		<div id="room_list_content">
			<?php
			foreach($dbmanager->getRooms(true) as $room) {
				if($room->song) {
					echo '<div class="col-sm-4">
				<div class="panel panel-default">
					<div class="panel-body room-card">
					<span class="room-header">
						<span class="room-name">'.$room->display_name.'</span><span class="room-users-wrapper"><span class="room-users">'.$room->user_counter.'</span><i class="fa fa-users"></i></span>
					</span>
						<img src="'.str_replace("default", "hqdefault", $room->song->picture_url).'">
					</div>
					<div class="panel-footer">
					<span class="song-name">
						'.$room->song->name.'
					</span>
					<span class="song-artist">
						'.$room->song->artist.'
					</span>
						<button class="btn btn-info footer_option" onclick="switchRoom(\''.$room->id.'\')">Join</button>
					</div>
				</div>
			</div>'."\n";
				} else {
					echo '<div class="col-sm-4 room-card">
				<div class="panel panel-default">
					<div class="panel-body">
						<span class="room-name">'.$room->display_name.'</span><span class="room-users-wrapper"><span class="room-users">'.$room->user_counter.'</span><i class="fa fa-users"></i></span>
						<br><span class="no-song">No song playing</span>
					</div>
					<div class="panel-footer">
						<button class="btn btn-info footer_option" onclick="switchRoom(\''.$room->id.'\')">join</button>
					     </div>
				</div>
			</div>'."\n";
				}
			}
			?>
		</div>
	</div>
</div>
<div id="now_playing" class="animsition player-container" hidden="hidden">
	<div id="now_playing_content" hidden="hidden">
		<div id="main_content">
			<div class="song-title-container">
				<h1 class="title_display"></h1>
				<h3 class="artist_display"></h3>
			</div>
			<div id="score_wrapper">
				<div class="score-positive-wrapper" onclick="vote(1)">
					<i class="fa fa-chevron-up"></i>
					<div id="score-positive" class="score"></div>
				</div>
				<div class="score-negative-wrapper" onclick="vote(-1)">
					<i class="fa fa-chevron-down"></i>
					<div id="score-negative" class="score"></div>
				</div>
				<div class="current-dj-wrapper" hidden="hidden">
					<span class="current-dj-caption">Current DJ: </span>
					<span id="current-dj"></span>
				</div>
				<?php
				if($is_owner) {
					echo '<div id="skip_song">
					<i class="fa fa-chevron-right"></i> Force Skip
				</div>';
				}
				?>
			</div>
			<div id="time_elapsed">
				<div></div>
			</div>
			<span id="time-remaining">0:00</span>
			<br>
			<div id="player" class="youtube-player"></div>
			<div id="video_options">
				<div id="video-toggle" onclick="togglePlayerVisibility()">
					<i class="fa fa-eye"></i>
				</div>
				<div id="volume-toggle" style="margin-right: 10px">
					<i class="fa fa-volume-down"></i>
				</div>
				<input type="range" value="50" min="0" max="100" id="volume-slider">
			</div>
		</div>
		<div id="no_video" hidden="hidden">
			<span class="big-header">Awkward silence...</span>
			<div class="small-header">No song is in the queue to play. You can add one from your collection using the sidebar to the right.</div>
		</div>
		<div id="room-info">
			<div id="in-room">
				<span id="room-title" class="room-title"></span>
				<span id="room-description-wrapper">
					<span id="room-description">

					</span>
					<span id="room-description-extend" hidden="hidden">read more...</span>
				</span>
				<span id="room-users-wrapper">
					<span id="room-users" class="focused"></span>
					<span class="subcaption subcaption-users">listening</span>
					<span id="room-queue" class="focused"></span>
					<span class="subcaption subcaption-queue">in queue</span>
				</span>
			</div>
			<div id="manual" hidden="hidden">
				<span id="playlist-title"></span>
				<span id="add-to-queue" class="manual-option"><a href="#"><i class="fa fa-plus"></i> add song to queue</a></span>
				<span id="manual-notice" class="manual-option"><a href="#" onclick="switchMode(0)"><i class="fa fa-chevron-left"></i> back to <span class="room-title"></span></a></span>
			</div>
			<div id="queue-container" hidden="hidden">
				Queue<br>
				<ul class="list-group queue-list-content">
				</ul>
				<span class="queue-status" hidden="hidden">Your song is playing.</span>
			</div>
		</div>
		<div id="chat">
			<div id="chat-text">

			</div>
			<div id="chat-textbox" class="input-group">
				<?php
				if(isset($authUrl)) {
					echo '<div class="chatbox-placeholder"><a href="' . $authUrl . '">Log in</a> to chat</div>';
				} else {
					foreach(array(
					        '<input type="text" class="form-control" placeholder="Say something nice" id="chat_message">',
					        '<span class="input-group-btn">',
					        '    <button class="btn btn-primary" type="button" id="chat_send">Send</button>',
					        '</span>') as $line) echo $line."\n";
				}
				?>
			</div>
		</div>
	</div>
	<div id="now_playing_placeholder">
		Join a room or queue a song from your collection to see controls here.
	</div>
</div>
<div id="create_room" class="animsition" hidden="hidden">
	<?php
	/*if(isset($create_error_message)) {
		echo '<div class="container"><div class="alert alert-warning" role="alert">'.$create_error_message.'</div></div>';
	}*/
	?>
	<div class="container create-form">
		Room creation is currently disabled.<br><br>
		<a onclick="showRoomList()">&laquo; Back</a>
		<?php
		/*if(!$user) {
			require("content/create/not_logged_in.php");
		} else {
			require("content/create/form.php");
		}*/
		?>
	</div>
</div>
<script src="http://totem.fm/js/vendor/jquery.js"></script>
<script src="http://totem.fm/js/vendor/jquery.animsition.min.js"></script>
<script src="http://totem.fm/js/common/transition.js"></script>
<script src="http://totem.fm/js/common/background.js"></script>
<script src="http://totem.fm/js/player/playback.js"></script>
<script src="http://totem.fm/js/player/sidebar.js"></script>
<script src="http://totem.fm/js/vendor/noty/packaged/jquery.noty.packaged.min.js"></script>
<script src="http://totem.fm/js/common/spin.js"></script>
<script src="http://totem.fm/js/vendor/bootstrap-modalmanager.js"></script>
<script src="http://totem.fm/js/vendor/bootstrap-modal.js"></script>
<script src="http://totem.fm/js/vendor/ba-linkify.min.js"></script>
<script src="http://totem.fm/api/start_session.php"></script>
<script src="http://totem.fm/js/common/app.js"></script>
</body>
</html>
